# Inline Image Generation

Расширение для SillyTavern. Ловит теги `[IMG:GEN:{...}]` в сообщениях ИИ и генерирует картинки через API.

## Формат тега

```
[IMG:GEN:{"style":"anime","prompt":"девушка с красными волосами"}]
```

- `style` — стиль генерации (опционально)
- `prompt` — описание картинки

## Настройки

Открыть Extensions → Генерация картинок

- **Тип API**: OpenAI-совместимый или Gemini (nano-banana)
- **URL эндпоинта**: базовый URL API
- **API ключ**: ключ авторизации
- **Модель**: выбрать из списка (кнопка обновления подтягивает модели с `/v1/models`)
- **Размер**: 1024x1024, 1792x1024, 1024x1792, 512x512
- **Качество**: standard / hd

### Для nano-banana / Gemini

Можно отправлять аватарки персонажей как референсы:
- Отправлять аватар {{char}}
- Отправлять аватар {{user}}

## Поддерживаемые API

**OpenAI-совместимый** — `/v1/images/generations`
- DALL-E, Midjourney, Stable Diffusion, FLUX и прочие через прокси

**Gemini-совместимый** — `/v1beta/models/{model}:generateContent`
- nano-banana, gemini-3-pro

## Как работает

1. ИИ пишет сообщение с тегом `[IMG:GEN:{...}]`
2. Расширение парсит тег, показывает спиннер
3. Отправляет запрос на API
4. Заменяет тег на сгенерированную картинку
5. Сохраняет в чат как `![prompt](data:image/png;base64,...)`

При ошибке показывает кнопку "Повторить". Автоматические ретраи с экспоненциальной задержкой для 429/502/503/504.

## Файлы

```
manifest.json  — метаданные расширения
index.js       — логика
style.css      — стили
```
